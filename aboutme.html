<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="navbar.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A bit more about me</title>
  <style>
    /* Page + palette */
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 0;
      background: #E9E1D6;
      color: #0B1C2D;
    }

    h1 { color: #1E3A5F; }
    section { margin: 10px; padding:60px 20px; }

    /* Full-width dark navbar (your exact style) */
    
    .wrap{ max-width: 1200px; margin: 0 auto; padding: 10px 24px 48px; }

    /* =============================
       STABLE, ALWAYS-PACKED MOSAIC
       ============================= */
    .mosaic{
      --cols: 6;                                  /* columns set via JS per width */
      --row: clamp(240px, 28vw, 400px);           /* base row height that scales */
      --gap: 8px;

      display: grid;
      grid-template-columns: repeat(var(--cols), 1fr);
      grid-auto-rows: var(--row);
      gap: var(--gap);
      grid-auto-flow: dense;  /* back-fill gaps from tall tiles */
    }

    /* Tiles get their spans from inline CSS vars set by JS */
    .tile{
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 6px 18px rgba(11,28,45,.12);
      cursor: pointer;
      outline: none;
      grid-column: span var(--w, 1);
      grid-row: span var(--h, 1);
      background: #ddd;
    }

    /* Image fill */
    .tile img{ width: 100%; height: 100%; object-fit: cover; display: block; transition: filter .25s ease, transform .25s ease; }

    /* Overlay for captions */
    .overlay{ position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; padding: 18px; text-align: center; color: #0B1C2D; background: rgba(233,225,214,0.55); backdrop-filter: blur(0px); -webkit-backdrop-filter: blur(0px); opacity: 0; transition: opacity .25s ease, backdrop-filter .25s ease; }
    .overlay .text{ max-width: 90%; font-weight: 600; font-size: 18px; line-height: 1.35; }

    /* Active (clicked) state */
    .tile.active img{ filter: blur(4px) brightness(.75); transform: scale(1.02); }
    .tile.active .overlay{ opacity: 1; backdrop-filter: blur(2px); -webkit-backdrop-filter: blur(2px); }

    /* Hover hint */
    .tile:not(.active)::after{ content: "Click"; position: absolute; bottom: 10px; right: 12px; font-size: 12px; padding: 2px 8px; color: #0B1C2D; opacity: 0; transform: translateY(4px); transition: .2s ease; }
    .tile:hover::after{ opacity: 1; transform: translateY(0); }

    @media (max-width: 480px){ .mosaic{ --row: 110px; --gap: 6px; } }
  </style>
</head>

<body>
  <nav class="navbar">
    <a href="index.html">Home</a>
    <a href="cv.html">CV</a>
    <a href="projects.html">Projects</a>
    <a href="aboutme.html">About me</a>
    <a href="contact.html">Contact</a>
  </nav>

  <header class="wrap">
    <h1>A bit more about me</h1>
    <p class="sub">You have the possibility to click on each picture to know more</p>
  </header>

  <main class="wrap">
    <section class="mosaic" id="mosaic" aria-label="Photo mosaic of projects"></section>
  </main>

  <script>
    // =====================
    // 1) Image data (edit)
    // =====================
    const IMAGES = [
      {src: 'Bib.png', alt:'bib', caption:'Study Session at the Rolex Learning Center'},
      {src: 'about me/CPH.png', alt:'trips', caption:'Ny Carlsberg Glyptotek, Denmark'},
      {src: 'about me/Lake.png', alt:'CH', caption:'Relaxing at Seealpsee in between exams'},
      {src: 'about me/Mountain1.png', alt:'Books and notes', caption:'Chamonix to ski'},
      {src: 'about me/Mountain2.png', alt:'Forest trail', caption:'Famous Zermatt slopes'},
      {src: 'about me/Python.png', alt:'Coffee shop', caption:'Late night working on Python projects'},
      {src: 'about me/Roma1.png', alt:'Snowy peak', caption:'Memory of a Museum in Roma'},
      {src: 'about me/WASH1.png', alt:'Studio desk', caption:'WASH logo'},
      {src: 'about me/SWISS.png', alt:'Harbor', caption:'Visit of theSWISS hangar'},
      {src: 'about me/Roma2.png', alt:'Mountain view', caption:'Trevi Fountain'},
      {src: 'about me/WASH2.png', alt:'River bend', caption:'WASH promotion on campus'},
      {src: 'about me/WASH3.png', alt:'Desert road', caption:'WASH self defense class'},
      {src: 'about me/WASH4.png', alt:'Pier', caption:'WASH Talk'},
      {src: 'about me/Rorschach.png', alt:'Field', caption:'Bodensee from Rorschach'},
      {src: 'about me/Boat.png', alt:'Waves', caption:'Bodensee boat party'},
      {src: 'about me/StGallen.png', alt:'Forest light', caption:'St. Gallen library'}
    ];

    const mosaic = document.getElementById('mosaic');

    // Build tiles once
    const tiles = IMAGES.map((img) => {
      const article = document.createElement('article');
      article.className = 'tile';
      article.tabIndex = 0;
      article.setAttribute('role','button');
      article.setAttribute('aria-pressed','false');

      const image = document.createElement('img');
      image.loading = 'lazy';
      image.src = img.src; image.alt = img.alt;

      const overlay = document.createElement('div');
      overlay.className = 'overlay';
      const text = document.createElement('div');
      text.className = 'text';
      text.textContent = img.caption;
      overlay.appendChild(text);

      article.appendChild(image);
      article.appendChild(overlay);
      mosaic.appendChild(article);
      return article;
    });

    // ==============================
    // 2) Deterministic layout logic
    // ==============================
    const LAYOUT_KEY_PREFIX = 'mosaic-layout-v1'; // bump this if logic changes

    function computeCols(container){
      const w = container.clientWidth;
      if (w >= 1100) return 6;  // desktop
      if (w >= 700)  return 4;  // tablet
      return 2;                 // mobile
    }

    // Fast string hash → 32-bit (FNV-ish)
    function hashString(str){
      let h = 2166136261 >>> 0;
      for (let i = 0; i < str.length; i++) {
        h ^= str.charCodeAt(i);
        h = Math.imul(h, 16777619);
      }
      return h >>> 0;
    }
    // Small, deterministic PRNG
    function mulberry32(a){
      return function(){
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }

    function packDeterministic(){
      const cols = computeCols(mosaic);
      mosaic.style.setProperty('--cols', cols);

      // One saved layout per column count (so 6-col layout stays stable, 4-col stays stable, etc.)
      const KEY = `${LAYOUT_KEY_PREFIX}-${cols}`;
      const stored = JSON.parse(localStorage.getItem(KEY) || 'null');

      if (stored && stored.items && stored.items.length === tiles.length) {
        // Apply stored spans
        stored.items.forEach((it, i) => {
          tiles[i].style.setProperty('--w', it.w);
          tiles[i].style.setProperty('--h', it.h);
        });
        return;
      }

      // Otherwise compute deterministically using a seed derived from image list + cols
      const seedSource = tiles.map(t => t.querySelector('img').src).join('|') + `|cols=${cols}`;
      const rand = mulberry32(hashString(seedSource));

      let remaining = cols;
      const items = [];

      for (let i = 0; i < tiles.length; i++){
        // Width: only 1 or 2 so each row sums exactly to cols
        let w = remaining === 1 ? 1 : (rand() < 0.55 ? 2 : 1);
        if (w > remaining) w = remaining;
        remaining -= w;
        if (remaining === 0) remaining = cols; // new row

        // Height: mostly 1–2, sometimes 3
        const r = rand();
        const h = r < 0.6 ? 1 : (r < 0.9 ? 2 : 3);

        tiles[i].style.setProperty('--w', w);
        tiles[i].style.setProperty('--h', h);
        items.push({ w, h });
      }

      localStorage.setItem(KEY, JSON.stringify({ items }));
    }

    // Initial pack and re-pack on resize (debounced)
    packDeterministic();
    let raf;
    window.addEventListener('resize', () => {
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(packDeterministic);
    });

    // ======================
    // 3) Interactions (blur)
    // ======================
    function toggleTile(tile){
      const isActive = tile.classList.toggle('active');
      tile.setAttribute('aria-pressed', isActive ? 'true' : 'false');
    }

    tiles.forEach(tile => {
      tile.addEventListener('click', () => toggleTile(tile));
      tile.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); toggleTile(tile); }
      });
    });

    document.addEventListener('click', (e) => {
      const t = e.target.closest('.tile');
      if(!t){ document.querySelectorAll('.tile.active').forEach(el => el.classList.remove('active')); }
    }, true);
  </script>
</body>
</html>
